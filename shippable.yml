language: python
build_image: shippableimages/ubuntu1404_python
python:
- 2.7

services:
- postgres

env:
  global:
  - SHIPPABLE_POSTGRES_VERSION="9.4"
  - SQLALCHEMY_DATABASE_URI="postgresql://test:test@localhost/test"

before_install:
- sudo apt-get update
- sudo apt-get install --yes --no-install-recommends
        git-core
        libffi-dev
        libpq-dev
        python-dev
        python-pip
        python-wheel

install:
- sudo pip install -r ./requirements-dev.txt
- sudo pip install -r ./requirements.txt

build:
  ci:
  - psql -c "create role test login password 'test';" -U postgres
  - psql -c "create database test;" -U postgres

script:
- ./run_tests

# after_success:
# - ./some_magic_command
